class CreateEmailDomain < ActiveRecord::Migration[6.0]
  def change
    execute <<~SQL
      CREATE DOMAIN email
      AS citext
      CHECK (value ~ '^[a-zA-Z0-9.!#$%&''*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$');
    SQL
  end
end
